<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MHIF IIR Reference - 5&nbsp; Useful R Programming Tips</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stats.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Useful R Programming Tips</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MHIF IIR Reference</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./iir_study_cycle.html" class="sidebar-item-text sidebar-link">2 IIR Study Cycle</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./refIRBPrep.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">IRB Preparation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_workflow.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Statistics Workflow</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_tips.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Useful R Programming Tips</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#copy-a-column-from-a-data-frame-to-another-with-matching-ids" id="toc-copy-a-column-from-a-data-frame-to-another-with-matching-ids" class="nav-link active" data-scroll-target="#copy-a-column-from-a-data-frame-to-another-with-matching-ids"><span class="toc-section-number">5.1</span>  Copy a column from a data frame to another with matching IDs</a></li>
  <li><a href="#how-to-access-column-names-in-a-loop-or-a-function-with-dplyr" id="toc-how-to-access-column-names-in-a-loop-or-a-function-with-dplyr" class="nav-link" data-scroll-target="#how-to-access-column-names-in-a-loop-or-a-function-with-dplyr"><span class="toc-section-number">5.2</span>  How to access column names in a loop or a function with dplyr</a></li>
  <li><a href="#how-to-effectively-use-dplyracross" id="toc-how-to-effectively-use-dplyracross" class="nav-link" data-scroll-target="#how-to-effectively-use-dplyracross"><span class="toc-section-number">5.3</span>  How to effectively use <code>dplyr::across()</code></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Useful R Programming Tips</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<style>
.scroll-plot {
  width: auto;
  height: 600px;
  overflow-y: scroll;
  overflow-x: hidden;
}
</style>
<p>This section of the guidebook will discuss useful tips in R programming that would be helpful in any IIR projects. This article assumes that you have basic knowledge in R programming. If you are not familiar with R, we suggest that you read this free online book <a href="https://rstudio-education.github.io/hopr/index.html">Hands-On Programming with R</a>.</p>
<section id="copy-a-column-from-a-data-frame-to-another-with-matching-ids" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="copy-a-column-from-a-data-frame-to-another-with-matching-ids"><span class="header-section-number">5.1</span> Copy a column from a data frame to another with matching IDs</h2>
<p>Suppose you have 2 data frames that are different in size. They share the same ID’s but the number of rows are different. Your goal is to copy one column from one data frame to another and you want the ID’s to match.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.2.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.2.2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>id, <span class="sc">~</span>year, <span class="sc">~</span>GPA,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">101</span>, <span class="dv">2011</span>, <span class="fl">3.5</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">102</span>, <span class="dv">2010</span>, <span class="fl">3.6</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">103</span>, <span class="dv">2012</span>, <span class="fl">2.8</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">104</span>, <span class="dv">2017</span>, <span class="fl">3.8</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">105</span>, <span class="dv">2016</span>, <span class="fl">2.6</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">101</span>, <span class="dv">2019</span>, <span class="fl">3.7</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">103</span>, <span class="dv">2021</span>, <span class="fl">2.5</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>id, <span class="sc">~</span>name, <span class="sc">~</span>school,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="dv">104</span>, <span class="st">"Jane Doe"</span>,<span class="st">"Oakhill Academy"</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="dv">101</span>, <span class="st">"John Smith"</span>, <span class="st">"Faireview International School"</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">103</span>, <span class="st">"James Lee"</span>, <span class="st">"Redwood College"</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">102</span>, <span class="st">"Jordan Jones"</span>, <span class="st">"Lakeville University"</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">105</span>, <span class="st">"Julia Garcia"</span>, <span class="st">"Mountainview Institute"</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
     id  year   GPA
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1   101  2011   3.5
2   102  2010   3.6
3   103  2012   2.8
4   104  2017   3.8
5   105  2016   2.6
6   101  2019   3.7
7   103  2021   2.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
     id name         school                        
  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;                         
1   104 Jane Doe     Oakhill Academy               
2   101 John Smith   Faireview International School
3   103 James Lee    Redwood College               
4   102 Jordan Jones Lakeville University          
5   105 Julia Garcia Mountainview Institute        </code></pre>
</div>
</div>
<p>Suppose your goal was to copy the column <code>name</code> from <code>B</code> to <code>A</code> only. A naive approach for this task would be to use <code>mutate</code> in the following way. However, this will generate an error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> A <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">name_from_b =</span> B[, <span class="st">"name"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `mutate()`:
! Problem while computing `name_from_b = B[, "name"]`.
✖ `name_from_b` must be size 7 or 1, not 5.</code></pre>
</div>
</div>
<p>Since the number of rows are different for the data frames <code>A</code> and <code>B</code>, <code>name</code> cannot be copied. Remember the goal is to copy the column so that the ID’s are matching. To make this work, we will use the function <code>match</code> and data frame indexing with brackets <code>[]</code>. First, we will explore how the <code>match</code> function works.</p>
<p><code>match</code> takes in vectors and returns the indices of the first argument that matches the second argument. For instance <code>match(x, y)</code> would return the indices of <code>x</code>’s elements that are matching the elements of <code>y</code> in the correct order.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">match</span>(B<span class="sc">$</span>id, A<span class="sc">$</span>id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 1 3 2 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">match</span>(A<span class="sc">$</span>id, B<span class="sc">$</span>id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 4 3 1 5 2 3</code></pre>
</div>
</div>
<p>Notice that the function still returns the indices of the matches even if the arguments of its arguments have differing lengths. If the arguments have differing lengths, the result of <code>match</code> will be the length of the first argument. The first example <code>match(B$id, A$id)</code> returns only 5 indices and these are the positions of the matches of <code>B</code>’s Id in <code>A</code>. The second example returns 7 elements in the same manner. Now we can use this to create a new vector <code>names_from_b</code> to be copied to <code>A</code>. This will be an easy task with data frame indexing using the brackets <code>[]</code>. Inside the brackets will be the matches of <code>A</code>’s ID in <code>B</code> so that there would be 7 elements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>names_from_b <span class="ot">&lt;-</span> B<span class="sc">$</span>name[<span class="fu">match</span>(A<span class="sc">$</span>id, B<span class="sc">$</span>id)]</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>names_from_b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "John Smith"   "Jordan Jones" "James Lee"    "Jane Doe"     "Julia Garcia"
[6] "John Smith"   "James Lee"   </code></pre>
</div>
</div>
<p>The final step is to copy this vector into <code>A</code>. We will store the result in a new data frame called <code>C</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> A <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">names =</span> names_from_b)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
     id  year   GPA names       
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       
1   101  2011   3.5 John Smith  
2   102  2010   3.6 Jordan Jones
3   103  2012   2.8 James Lee   
4   104  2017   3.8 Jane Doe    
5   105  2016   2.6 Julia Garcia
6   101  2019   3.7 John Smith  
7   103  2021   2.5 James Lee   </code></pre>
</div>
</div>
</section>
<section id="how-to-access-column-names-in-a-loop-or-a-function-with-dplyr" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="how-to-access-column-names-in-a-loop-or-a-function-with-dplyr"><span class="header-section-number">5.2</span> How to access column names in a loop or a function with dplyr</h2>
<p>In base R, we need <code>$</code> to refer to variables/columns of a data frame in most cases. This often leads to repetition of typing the same data frame’s name many times. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mtcars[mtcars<span class="sc">$</span>mpg <span class="sc">&gt;</span> <span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg) <span class="sc">&amp;</span> mtcars<span class="sc">$</span>gear <span class="sc">==</span> <span class="dv">4</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4      21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag  21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710     22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Merc 240D      24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230       22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Fiat 128       32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Honda Civic    30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Toyota Corolla 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
Fiat X1-9      27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
Volvo 142E     21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</code></pre>
</div>
</div>
<p>In <code>dplyr</code>, a concept called data masking allows for much faster data manipulation and reduces such repetition of code. In short, data masking allows you to simply type only the name of variable instead of accessing the variable through <code>$</code> operator. The code above could be reduced to this using <code>dplyr</code>’s <code>filter()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> <span class="fu">filter</span>(mpg <span class="sc">&gt;</span> <span class="fu">mean</span>(mpg) <span class="sc">&amp;</span> gear <span class="sc">==</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4      21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag  21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710     22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Merc 240D      24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230       22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Fiat 128       32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Honda Civic    30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Toyota Corolla 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
Fiat X1-9      27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
Volvo 142E     21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</code></pre>
</div>
</div>
<p>However, when working with data masked variables, it is somewhat challenging to create functions and loops. It will usually throw an error if you try to use the data masked variables as is without manipulation. Suppose you wanted to create histogram of each variable in a dataset. You may do so by creating a histogram one by one. However, a more efficient way to complete this task would be to come up with some kind of a loop or a function. Here is an example attempt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> <span class="fu">names</span>(mtcars)){</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  plots <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> var)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plots)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `geom_histogram()`:
! Problem while computing stat.
ℹ Error occurred in the 1st layer.
Caused by error in `setup_params()`:
! `stat_bin()` requires a continuous x aesthetic
✖ the x aesthetic is discrete.
ℹ Perhaps you want `stat="count"`?</code></pre>
</div>
<div class="cell-output-display">
<p><img src="r_tips_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above code throws an error - the part <code>aes(x = var)</code> does not recognize the variable names we supplied to the function. <code>var</code> is just the names of the variables in <code>mtcars</code> stored in strings. To resolve this error, we need to access the masked variables. We can do so by indexing the <code>.data</code> pronoun with the variable names. The syntax would be <code>.data[[varname]]</code>.</p>
<div class="scroll-plot">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> <span class="fu">names</span>(mtcars)){</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  plots1 <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .data[[var]])) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plots1)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="r_tips_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="r_tips_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="r_tips_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="r_tips_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="r_tips_files/figure-html/unnamed-chunk-10-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="r_tips_files/figure-html/unnamed-chunk-10-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="r_tips_files/figure-html/unnamed-chunk-10-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="r_tips_files/figure-html/unnamed-chunk-10-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="r_tips_files/figure-html/unnamed-chunk-10-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="r_tips_files/figure-html/unnamed-chunk-10-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="r_tips_files/figure-html/unnamed-chunk-10-11.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<p>(reference: <a href="https://dplyr.tidyverse.org/articles/programming.html"><code>vignette("programming")</code></a> )</p>
</section>
<section id="how-to-effectively-use-dplyracross" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="how-to-effectively-use-dplyracross"><span class="header-section-number">5.3</span> How to effectively use <code>dplyr::across()</code></h2>
<p>It is tedious to copy same line of code for same operation across multiple columns. In <code>dplyr</code> package, the function <code>across()</code> allows the same operation to be carried on multiple columns without having to copy. Let’s examine the function first.</p>
<p><code>across(.cols = everything(), .fns = NULL)</code></p>
<ol type="1">
<li><code>.cols</code>: this argument selects the columns you want to do the operation. You would usually use the vector constructor <code>c()</code> to select columns, but also you can use the tidy-select helpers (<code>starts_with()</code>, <code>contains()</code>, <code>where()</code>, etc.) The where() helper is particularly useful.</li>
<li><code>.fns</code>: this argument takes a function, or list of functions, you want to apply. You can use a regular names function such as <code>mean()</code>, a purrr style lambda (formula) to create a function on the fly (e.g.&nbsp;<code>~.x * 2</code>), or a list of functions/lambdas, e.g.&nbsp;<code>list(avg = mean(), double = ~.x * 2)</code>. If you prefer, you can also create a custom anonymous function like <code>function(x) {…}</code></li>
</ol>
<p>Example use:</p>
<p>Suppose you wanted to change the data types of multiple columns, say from integer to character. A naive approach to do the task would be something like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>storms <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">where</span>(is.integer)) <span class="sc">|&gt;</span> <span class="fu">lapply</span>(typeof)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$day
[1] "integer"

$wind
[1] "integer"

$pressure
[1] "integer"

$tropicalstorm_force_diameter
[1] "integer"

$hurricane_force_diameter
[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>storms <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">day =</span> <span class="fu">as.character</span>(day),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">wind =</span> <span class="fu">as.character</span>(wind),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pressure =</span> <span class="fu">as.character</span>(pressure),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">tropicalstorm_force_diameter =</span> <span class="fu">as.character</span>(tropicalstorm_force_diameter),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">hurricane_force_diameter =</span> <span class="fu">as.character</span>(hurricane_force_diameter)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11,859 × 13
   name   year month day    hour   lat  long status        categ…¹ wind  press…²
   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;ord&gt;   &lt;chr&gt; &lt;chr&gt;  
 1 Amy    1975     6 27        0  27.5 -79   tropical dep… -1      25    1013   
 2 Amy    1975     6 27        6  28.5 -79   tropical dep… -1      25    1013   
 3 Amy    1975     6 27       12  29.5 -79   tropical dep… -1      25    1013   
 4 Amy    1975     6 27       18  30.5 -79   tropical dep… -1      25    1013   
 5 Amy    1975     6 28        0  31.5 -78.8 tropical dep… -1      25    1012   
 6 Amy    1975     6 28        6  32.4 -78.7 tropical dep… -1      25    1012   
 7 Amy    1975     6 28       12  33.3 -78   tropical dep… -1      25    1011   
 8 Amy    1975     6 28       18  34   -77   tropical dep… -1      30    1006   
 9 Amy    1975     6 29        0  34.4 -75.8 tropical sto… 0       35    1004   
10 Amy    1975     6 29        6  34   -74.8 tropical sto… 0       40    1002   
# … with 11,849 more rows, 2 more variables:
#   tropicalstorm_force_diameter &lt;chr&gt;, hurricane_force_diameter &lt;chr&gt;, and
#   abbreviated variable names ¹​category, ²​pressure
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>storms <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.integer), <span class="sc">~</span><span class="fu">as.character</span>(.x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11,859 × 13
   name   year month day    hour   lat  long status        categ…¹ wind  press…²
   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;ord&gt;   &lt;chr&gt; &lt;chr&gt;  
 1 Amy    1975     6 27        0  27.5 -79   tropical dep… -1      25    1013   
 2 Amy    1975     6 27        6  28.5 -79   tropical dep… -1      25    1013   
 3 Amy    1975     6 27       12  29.5 -79   tropical dep… -1      25    1013   
 4 Amy    1975     6 27       18  30.5 -79   tropical dep… -1      25    1013   
 5 Amy    1975     6 28        0  31.5 -78.8 tropical dep… -1      25    1012   
 6 Amy    1975     6 28        6  32.4 -78.7 tropical dep… -1      25    1012   
 7 Amy    1975     6 28       12  33.3 -78   tropical dep… -1      25    1011   
 8 Amy    1975     6 28       18  34   -77   tropical dep… -1      30    1006   
 9 Amy    1975     6 29        0  34.4 -75.8 tropical sto… 0       35    1004   
10 Amy    1975     6 29        6  34   -74.8 tropical sto… 0       40    1002   
# … with 11,849 more rows, 2 more variables:
#   tropicalstorm_force_diameter &lt;chr&gt;, hurricane_force_diameter &lt;chr&gt;, and
#   abbreviated variable names ¹​category, ²​pressure
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
</div>
<p>(reference: <code>vignette("colwise")</code>)</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stats.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Statistics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>